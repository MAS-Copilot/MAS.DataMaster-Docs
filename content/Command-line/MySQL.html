<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>MySQL 命令行操作 | DataMaster </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="MySQL 命令行操作 | DataMaster ">
      
      
      <link rel="icon" href="../../images/favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/MAS-Copilot/mas-data-master/blob/main/docs/content/Command-line/MySQL.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../images/logo.svg" alt="DataMaster">
            DataMaster
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="mysql-命令行操作">MySQL 命令行操作</h1>

<h2 id="基本连接与退出">基本连接与退出</h2>
<h3 id="连接mysql服务器">连接MySQL服务器</h3>
<pre><code class="lang-bash">mysql -u 用户名 -p
</code></pre>
<h3 id="指定主机和端口连接">指定主机和端口连接</h3>
<pre><code class="lang-bash">mysql -h 主机地址 -P 端口号 -u 用户名 -p
</code></pre>
<h3 id="退出mysql命令行">退出MySQL命令行</h3>
<pre><code class="lang-bash">exit;
-- 或
quit;
-- 或
\q
</code></pre>
<h2 id="数据库操作">数据库操作</h2>
<h3 id="显示所有数据库">显示所有数据库</h3>
<pre><code class="lang-bash">show databases;
</code></pre>
<h3 id="创建数据库">创建数据库</h3>
<pre><code class="lang-bash">CREATE DATABASE 数据库名;
</code></pre>
<h3 id="选择数据库">选择数据库</h3>
<pre><code class="lang-bash">USE 数据库名;
</code></pre>
<h3 id="删除数据库">删除数据库</h3>
<pre><code class="lang-bash">DROP DATABASE 数据库名;
</code></pre>
<h2 id="表操作">表操作</h2>
<h3 id="创建表">创建表</h3>
<pre><code class="lang-bash">CREATE TABLE 表名 (
    列名1 数据类型 [约束],
    列名2 数据类型 [约束],
    ...
);
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
</code></pre>
<h3 id="显示当前数据库中的所有表">显示当前数据库中的所有表</h3>
<pre><code class="lang-bash">show TABLES;
</code></pre>
<h3 id="查看表结构">查看表结构</h3>
<pre><code class="lang-bash">DESCRIBE 表名;
-- 或
DESC 表名;
</code></pre>
<h3 id="删除表">删除表</h3>
<pre><code class="lang-bash">DROP TABLE 表名;
</code></pre>
<h2 id="数据操作">数据操作</h2>
<h3 id="插入数据">插入数据</h3>
<pre><code class="lang-bash">INSERT INTO 表名 (列名1, 列名2, ...) VALUES (值1, 值2, ...);
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">INSERT INTO users (username, email) VALUES ('john', 'john@example.com');
</code></pre>
<h3 id="查询数据">查询数据</h3>
<pre><code class="lang-bash">SELECT 列名 FROM 表名 [WHERE 条件];
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">SELECT * FROM users;
SELECT username, email FROM users WHERE id = 1;
</code></pre>
<h3 id="更新数据">更新数据</h3>
<pre><code class="lang-bash">UPDATE 表名 SET 列1 = 值1, 列2 = 值2,... WHERE 条件;
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">UPDATE users SET email='new@example.com' WHERE id = 1;
</code></pre>
<h3 id="删除数据">删除数据</h3>
<pre><code class="lang-bash">DELETE FROM 表名 WHERE 列名 = 值;
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">DELETE FROM users WHERE id = 1;
</code></pre>
<h2 id="用户与权限管理">用户与权限管理</h2>
<h3 id="创建用户">创建用户</h3>
<pre><code class="lang-bash">CREATE USER '用户名'@'主机' IDENTIFIED BY '密码';
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">CREATE USER 'new_user'@'localhost' IDENTIFIED BY 'secure_password';
</code></pre>
<h3 id="显示所有用户">显示所有用户</h3>
<pre><code class="lang-bash">SELECT user, host FROM mysql.user;
</code></pre>
<h3 id="修改用户密码">修改用户密码</h3>
<pre><code class="lang-bash">ALTER USER '用户名'@'主机' IDENTIFIED BY '新密码';
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">ALTER USER 'new_user'@'localhost' IDENTIFIED BY 'new_password';
</code></pre>
<h3 id="删除用户">删除用户</h3>
<pre><code class="lang-bash">DROP USER '用户名'@'主机';
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">DROP USER 'new_user'@'localhost';
</code></pre>
<h3 id="授予权限">授予权限</h3>
<pre><code class="lang-bash">GRANT 权限 ON 数据库名.表名 TO '用户名'@'主机';
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">-- 允许查询数据
GRANT SELECT, INSERT ON mydatabase.* TO 'new_user'@'localhost';
-- 授予所有权限
GRANT ALL PRIVILEGES ON mydatabase.* TO 'new_user'@'localhost';
</code></pre>
<h3 id="权限列表">权限列表</h3>
<p><strong>数据库级别权限：</strong></p>
<table>
<thead>
<tr>
<th>权限名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ALL PRIVILEGES</td>
<td>授予所有权限（除GRANT OPTION外）</td>
</tr>
<tr>
<td>CREATE</td>
<td>允许创建数据库和表</td>
</tr>
<tr>
<td>DROP</td>
<td>允许删除数据库、表和视图</td>
</tr>
<tr>
<td>ALTER</td>
<td>允许修改表结构</td>
</tr>
<tr>
<td>SELECT</td>
<td>允许查询数据</td>
</tr>
<tr>
<td>INSERT</td>
<td>允许插入数据</td>
</tr>
<tr>
<td>UPDATE</td>
<td>允许更新数据</td>
</tr>
<tr>
<td>DELETE</td>
<td>允许删除数据</td>
</tr>
<tr>
<td>INDEX</td>
<td>允许创建和删除索引</td>
</tr>
<tr>
<td>REFERENCES</td>
<td>允许创建外键约束</td>
</tr>
</tbody>
</table>
<p><strong>管理类权限：</strong></p>
<table>
<thead>
<tr>
<th>权限名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>GRANT OPTION</td>
<td>允许用户将自己的权限授予其他用户</td>
</tr>
<tr>
<td>SUPER</td>
<td>允许使用管理员级命令（如CHANGE MASTER, KILL等）</td>
</tr>
<tr>
<td>PROCESS</td>
<td>允许查看所有正在运行的进程</td>
</tr>
<tr>
<td>RELOAD</td>
<td>允许执行FLUSH操作</td>
</tr>
</tbody>
</table>
<p><strong>特殊权限：</strong></p>
<table>
<thead>
<tr>
<th>权限名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>CREATE USER</td>
<td>允许创建、删除和重命名用户</td>
</tr>
<tr>
<td>SHOW DATABASES</td>
<td>允许查看所有数据库列表</td>
</tr>
<tr>
<td>LOCK TABLES</td>
<td>LOCK TABLES</td>
</tr>
<tr>
<td>REPLICATION</td>
<td>允许主从复制相关操作</td>
</tr>
</tbody>
</table>
<p><strong>权限作用范围说明：</strong></p>
<pre><code class="lang-sql">-- 1. 全局权限（*.*）
GRANT SELECT ON *.* TO 'user'@'host';

-- 2. 数据库级别权限（database.*）
GRANT ALL ON mydb.* TO 'user'@'host';

-- 3. 表级别权限（database.table）
GRANT SELECT ON mydb.mytable TO 'user'@'host';

-- 4. 列级别权限
GRANT SELECT(col1,col2) ON mydb.mytable TO 'user'@'host';

-- 5. 存储过程和函数权限
GRANT EXECUTE ON PROCEDURE mydb.myproc TO 'user'@'host';
</code></pre>
<h3 id="查看用户权限">查看用户权限</h3>
<pre><code class="lang-bash">SHOW GRANTS FOR '用户名'@'主机';
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">SHOW GRANTS FOR 'new_user'@'localhost';
</code></pre>
<h3 id="撤销权限">撤销权限</h3>
<pre><code class="lang-bash">REVOKE 权限 ON 数据库名.表名 FROM '用户名'@'主机';
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">REVOKE INSERT ON mydatabase.* FROM 'new_user'@'localhost';
</code></pre>
<h2 id="索引操作">索引操作</h2>
<h3 id="创建索引">创建索引</h3>
<pre><code class="lang-bash">CREATE INDEX 索引名 ON 表名 (列名);
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">CREATE INDEX idx_username ON users (username);
</code></pre>
<h3 id="创建唯一索引">创建唯一索引</h3>
<pre><code class="lang-bash">CREATE UNIQUE INDEX 索引名 ON 表名 (列名);
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">CREATE UNIQUE INDEX idx_email ON users (email);
</code></pre>
<h3 id="查看索引">查看索引</h3>
<pre><code class="lang-bash">SHOW INDEX FROM 表名;
</code></pre>
<h3 id="删除索引">删除索引</h3>
<pre><code class="lang-bash">DROP INDEX 索引名 ON 表名;
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">DROP INDEX idx_username ON users;
</code></pre>
<h2 id="事务管理">事务管理</h2>
<p>事务（Transaction）是数据库中一组操作的集合，这些操作要么全部成功执行，要么全部不执行（回滚）。事务的目的是确保数据的一致性和完整性，特别是在多个操作可能相互依赖的情况下</p>
<ul>
<li>Atomicity（原子性）：事务中的所有操作要么全部完成，要么全部不完成</li>
<li>Consistency（一致性）：事务执行前后，数据库的状态保持一致</li>
<li>Isolation（隔离性）：事务之间互不干扰</li>
<li>Durability（持久性）：事务一旦提交，数据永久保存</li>
</ul>
<h3 id="开启事务">开启事务</h3>
<pre><code class="lang-sql">START TRANSACTION;
</code></pre>
<h3 id="提交事务">提交事务</h3>
<pre><code class="lang-sql">COMMIT;
</code></pre>
<h3 id="回滚事务">回滚事务</h3>
<pre><code class="lang-sql">ROLLBACK;
</code></pre>
<h3 id="示例">示例</h3>
<pre><code class="lang-sql">START TRANSACTION;
INSERT INTO users (username, email) VALUES ('alice', 'alice@example.com');
UPDATE users SET email = 'alice_new@example.com' WHERE username = 'alice';
-- 如果成功
COMMIT;
-- 如果失败
ROLLBACK;
</code></pre>
<h2 id="数据备份与恢复">数据备份与恢复</h2>
<h3 id="备份数据库">备份数据库</h3>
<pre><code class="lang-bash">mysqldump -u 用户名 -p 数据库名 &gt; 备份文件.sql
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">mysqldump -u root -p mydatabase &gt; mydatabase_backup.sql
</code></pre>
<h3 id="恢复数据库">恢复数据库</h3>
<pre><code class="lang-bash">mysql -u 用户名 -p 数据库名 &lt; 备份文件名.sql
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">mysql -u root -p mydatabase &lt; mydatabase_backup.sql
</code></pre>
<h2 id="常用查询操作">常用查询操作</h2>
<h3 id="排序查询">排序查询</h3>
<pre><code class="lang-bash">SELECT 列名 FROM 表名 ORDER BY 列名 [ASC|DESC];
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">SELECT * FROM users ORDER BY created_at DESC;
</code></pre>
<h3 id="分组查询">分组查询</h3>
<pre><code class="lang-bash">SELECT 列名, 聚合函数 FROM 表名 GROUP BY 列名;
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">SELECT COUNT(*) AS user_count, created_at FROM users GROUP BY DATE(created_at);
</code></pre>
<h3 id="限制查询结果数量">限制查询结果数量</h3>
<pre><code class="lang-bash">SELECT 列名 FROM 表名 LIMIT 数量;
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">SELECT * FROM users LIMIT 5;
</code></pre>
<h3 id="分页查询">分页查询</h3>
<pre><code class="lang-bash">SELECT 列名 FROM 表名 LIMIT 数量 OFFSET 偏移量;
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">SELECT * FROM users LIMIT 10 OFFSET 20; -- 跳过前20条，获取10条
</code></pre>
<h2 id="其他实用命令">其他实用命令</h2>
<h3 id="查看当前数据库">查看当前数据库</h3>
<pre><code class="lang-sql">SELECT DATABASE();
</code></pre>
<h3 id="查看-mysql-版本">查看 MySQL 版本</h3>
<pre><code class="lang-sql">SELECT VERSION();
</code></pre>
<h3 id="查看当前用户">查看当前用户</h3>
<pre><code class="lang-sql">SELECT USER();
</code></pre>
<h3 id="设置字符集">设置字符集</h3>
<pre><code class="lang-sql">SET NAMES utf8mb4;
</code></pre>
<ul>
<li>设置客户端、连接和结果的字符集为<code>utf8mb4</code>，确保支持多语言和表情符号</li>
<li>等效于设置<code>character_set_client</code>、<code>character_set_connection</code>和<code>character_set_results</code></li>
</ul>
<h3 id="查看表创建语句">查看表创建语句</h3>
<pre><code class="lang-bash">SHOW CREATE TABLE 表名;
</code></pre>
<ul>
<li>显示指定表的创建语句，包括字段定义、索引、字符集等</li>
<li>表的完整<code>CREATE TABLE</code>语句，适合备份或迁移表结构</li>
</ul>
<h3 id="清空表数据保留结构">清空表数据（保留结构）</h3>
<pre><code class="lang-sql">TRUNCATE TABLE 表名;
</code></pre>
<ul>
<li>删除表中的所有数据，但保留表结构、索引和约束</li>
<li>比<code>DELETE FROM</code>表名; 更快，但无法回滚，且会重置<code>AUTO_INCREMENT</code>计数器</li>
</ul>
<h3 id="执行-sql-文件">执行 sql 文件</h3>
<pre><code class="lang-bash">source 文件名.sql;
-- 或
\. 文件名.sql;
</code></pre>
<ul>
<li>从指定 SQL 文件中执行命令，常用于批量导入数据或运行脚本</li>
</ul>
<h3 id="查看当前连接数">查看当前连接数</h3>
<pre><code class="lang-sql">SHOW STATUS LIKE 'Threads_connected';
</code></pre>
<ul>
<li>显示当前数据库服务器已打开的连接数</li>
</ul>
<h3 id="重置自增计数器">重置自增计数器</h3>
<pre><code class="lang-bash">ALTER TABLE 表名 AUTO_INCREMENT = 1;
</code></pre>
<ul>
<li>在清空表或调整数据后重新开始自增 ID</li>
</ul>
<h2 id="性能优化相关">性能优化相关</h2>
<h3 id="分析查询性能">分析查询性能</h3>
<pre><code class="lang-bash">EXPLAIN SELECT 列名 FROM 表名 WHERE 条件;
</code></pre>
<p><strong>示例：</strong></p>
<pre><code class="lang-sql">EXPLAIN SELECT * FROM users WHERE username = 'john';
</code></pre>
<h3 id="查看运行状态">查看运行状态</h3>
<pre><code class="lang-sql">SHOW STATUS;
</code></pre>
<h3 id="优化表">优化表</h3>
<pre><code class="lang-sql">OPTIMIZE TABLE 表名;
</code></pre>
<h2 id="配置-mysql-允许远程访问">配置 MySQL 允许远程访问</h2>
<p>在同一局域网内，电脑 B 需要访问电脑 A 上的 MySQL 数据库</p>
<ul>
<li><p>MySQL配置文件（my.ini）通常位于安装目录的data文件夹或默认配置路径，找到 [mysqld] 部分</p>
<pre><code class="lang-ini"># 允许监听所有IP（危险！仅限内网环境）
[mysqld]
bind-address = 0.0.0.0
</code></pre>
</li>
<li><p>运行<code>services.msc</code>重启 MySql 服务器</p>
</li>
<li><p>检查用户权限</p>
<pre><code class="lang-sql">SELECT user, host FROM mysql.user;
</code></pre>
</li>
<li><p>授权 IP</p>
<ul>
<li><p>允许192.168.1.20的 DBA 客户端完全访问</p>
<pre><code class="lang-sql">CREATE USER '用户名'@'192.168.1.20' IDENTIFIED BY '密码';
GRANT ALL PRIVILEGES ON *.* TO '用户名'@'192.168.1.20' WITH GRANT OPTION;
</code></pre>
</li>
<li><p>允许192.168.1.%网段的应用服务器只读访问</p>
<pre><code class="lang-sql">CREATE USER '用户名'@'192.168.1.%' IDENTIFIED BY '密码';
GRANT SELECT ON 数据库名.* TO '用户名'@'192.168.1.%';
</code></pre>
</li>
<li><p>将 root 账户的 Host 字段从 localhost 修改为 %，从而允许 root 账户从任意 IP 连接 MySQL</p>
<pre><code class="lang-sql">UPDATE mysql.user SET Host = '%' WHERE User = 'root';
</code></pre>
</li>
</ul>
</li>
<li><p>权限生效</p>
<pre><code class="lang-sql">FLUSH PRIVILEGES; -- 刷新权限缓存
</code></pre>
</li>
</ul>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/MAS-Copilot/mas-data-master/blob/main/docs/content/Command-line/MySQL.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx" rel="noreferrer">docfx</a>,  | Copyright (c) MAS(厦门威光) Corporation. All rights reserved.</span>
        </div>
      </div>
    </footer>
  </body>
</html>
